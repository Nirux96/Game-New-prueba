<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Game</title>
  <link rel="stylesheet" href="static/client/game.css">
  <link rel="stylesheet" href="static/client/background-custom.css">
</head>
<script src="static/client/pixi/pixi.min.js"></script>
<script src="socket.io/socket.io.js"></script>
<script src="static/client/controller.js"></script>

<body>
  <div id="gameContainer">
    <!-- El canvas del juego se insertará aquí -->
  </div>
  <script>
"use strict";
let leaderboard = [];
var controller = new Controller();

</script><script src="static/client/view.js"></script><script>
function Terrain(pathArg)  {
  this.path=pathArg;
}
document.getElementById('gameContainer').appendChild(app.view);

let gameMap = new GameMap();
let players = [];
let bullets = [];
let items = [];
let currentPlayer = new CurrentPlayer();

////////////////////////////////////////////////////////////////////////////////
let socket = io();

let input = {
  up: false,
  down: false,
  left: false,
  right: false,
  direction:  Math.PI,
  LMB: false,
}

document.addEventListener('keydown', function(event) {
  switch (event.keyCode) {
    case 65: // A
    input.left = true;
    break;
    case 87: // W
    input.up = true;
    break;
    case 68: // D
    input.right = true;
    break;
    case 83: // S
    input.down = true;
    break;
  }
});

document.addEventListener('keyup', function(event) {
  switch (event.keyCode) {
    case 65: // A
    input.left = false;
    break;
    case 87: // W
    input.up = false;
    break;
    case 68: // D
    input.right = false;
    break;
    case 83: // S
    input.down = false;
    break;
  }
});

document.addEventListener('mousemove', function(event) {
  // Obtener la posición del canvas en la página
  const rect = app.view.getBoundingClientRect();
  const centerX = rect.left + rect.width / 2;
  const centerY = rect.top + rect.height / 2;
  
  // Calcular el ángulo desde el centro del canvas hasta el mouse
  const dx = event.clientX - centerX;
  const dy = event.clientY - centerY;
  
  // Usar atan2 para obtener el ángulo correcto en todos los cuadrantes
  currentPlayer.direction = Math.atan2(dy, dx);
  input.direction = currentPlayer.direction;
});

document.addEventListener("mousedown", function() {
    input.LMB=true;
});
document.addEventListener("mouseup", function() {
    input.LMB=false;
});



</script>

</body>
</html>
